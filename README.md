
# TikTok Shop Affiliates API

##  Project Overview

#### The Tiktok shop affiliate programme pays commission to users who create entertaining videos that advertises Tiktok shop products. 
#### This api is designed to track videos of products sold in the Tiktok shop created by Tiktok shop affiliates
#### The API interacts with MySQL database and allows users to:
* Retrieve a list of Tiktok shop affiliates
* Retrieve videos by country 
* Calculate affiliate earnings based on product sales generated by the videos
* Add new video data when new videos are produced. 

**Please note that the data is fictional and created for the purposes of this assignment only.** 


## Project Requirements

#### 1. Python 3.x

#### 2. MySQL

#### 3. Python Packages:
- flask
- requests 
- json
- jsonify

## Installation
### 1. Install packages
Install required Python packages as stated in the previous section

### 2. Create database "tiktok_affiliates" in Mysql
#### Use the data present in the file: ```tiktok_affiliate_DB.sql```
Two tables can then be created:
 - ```affiliates``` 
 - ```videos``` 


### 3. Update ```config.py``` with your MySQL credentials.
>[!NOTE] Ensure you have used your own mySQL password

```bash 
USER = "root"
PASSWORD = "your_password"
HOST = "localhost"
DATABASE = "tiktok_affiliates"
```

### 4. Run the ```db_utils.py``` and check that it is connecting to MySql server.
Run the following commands to retrieve data from the database to check connection to the MySql server.
```bash
if __name__ == "__main__":
    print("TESTING DB CONNECTION")
    print(fetch_all_affiliates())
 ```

![db_utils](images/db_utils_connect.png)

### 5. Run the Flask API: ```ttvideo_api.py```

![Flask output](images/api_py.png)

The API will run on ```http://127.0.0.1:5000```.
>[!NOTE] Ensure MySQL database is running before starting the Flask app 


### 6. API Endpoints

| Method | Endpoint          | Description                                                          |
|:-------|:------------------|:---------------------------------------------------------------------|
| GET    | /affiliates"      | Retrieve all affiliates                                              |
| GET    | /videos/{country} | Fetch all videos by country. Replace <country> with the country name |
| GET    | /earnings         | Fetch calculated total earnings/comissions for each video            |
| POST   | /add              | Adds new video dictionary to the video table                         |


![Endpoint - http://127.0.0.1:5000\affiliates](assignment-4-APIs\images\affiliates.png)

![Endpoint - http://127.0.0.1:5000/earnings](assignment-4-APIs\images\earnings.png)



## Client-Side Interaction -  main.py


#### To interact with the API, run the ```main.py``` file which provides a command-line interface for the user to:

- View all affiliates.
- View videos by country.
- View total earnings and the top earning video
- Add a new video to the database.

### Run the following options to start the client:

Examples 

### 1. View all affiliates
```bash
Enter your choice: 1
```

### 2. View videos by country - sample input
```bash
Enter your choice: 2
Enter name of country from this list ['USA', 'UK', 'Poland', 'Spain']: UK
```

### 3. View earnings for each video and the top earning video
```bash
Enter your choice: 3
```
### 4. Add New Video - sample input
```bash
Enter your choice: 4 
Affiliate_id: 1 
Name of product: White joggers 
Number of views: 345  
Commission per sale: 1.25 
Number of sales: 30 
```

![Query Output](images/query_output.png)

Thank you!
